<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fairway Forecast</title>

  <link rel="stylesheet" href="./style.css?v=31" />

  <!-- Leaflet (map) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
    defer
  ></script>

  <!-- Reminder: config.js must define window.APP_CONFIG -->
  <script src="./config.js?v=31"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script src="./script.js?v=31" defer></script>
</head>

<body>
  <div class="appShell">

    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sideTop">
        <div class="logoMark">â›³</div>
        <div class="brand">
          <div class="brandName">Fairway Forecast</div>
          <div class="brandSub">Golf-first weather</div>
        </div>
      </div>

      <nav class="sideNav">
        <button class="navBtn active" data-view="current">
          <span class="navIcon">â˜€ï¸</span><span>Current</span>
        </button>
        <button class="navBtn" data-view="hourly">
          <span class="navIcon">ğŸ•’</span><span>Hourly</span>
        </button>
        <button class="navBtn" data-view="daily">
          <span class="navIcon">ğŸ“…</span><span>Daily</span>
        </button>
        <button class="navBtn" data-view="courses">
          <span class="navIcon">ğŸŒï¸</span><span>Courses</span>
        </button>
      </nav>

      <div class="sideBottom">
        <div class="miniRow">
          <label class="miniLabel" for="ddlUnits">Units</label>
          <select id="ddlUnits" class="select">
            <option value="C">Â°C</option>
            <option value="F">Â°F</option>
          </select>
        </div>

        <div class="statusSmall" id="appStatus"></div>
        <div class="statusSmall" id="coursesStatus"></div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <!-- Top bar -->
      <header class="topbar">
        <div class="chipsRow" id="quickChips"></div>

        <div class="topActions">
          <div class="searchGroup">
            <span class="searchLabel">Location</span>
            <div class="searchRow">
              <input id="txtSearch" class="input" placeholder="Search for location (e.g. Swindon, GB)" />
              <button id="btnSearch" class="btn">Search</button>
              <button id="btnGeo" class="btn ghost" title="Use my location">âŒ–</button>
            </div>
          </div>

          <div class="searchGroup">
            <span class="searchLabel">Golf course</span>
            <div class="searchRow">
              <input id="txtCourseFilter" class="input" placeholder="Type to filter coursesâ€¦" />
              <select id="ddlCourses" class="select wide">
                <option value="">Courses (loadingâ€¦)</option>
              </select>
              <button id="btnFavToggle" class="btn star" title="Add/remove favourite">â˜†</button>
            </div>
            <div class="favRow">
              <select id="ddlFavs" class="select wide">
                <option value="">No favourites yet</option>
              </select>
            </div>
          </div>
        </div>
      </header>

      <!-- Content grid -->
      <section class="grid">

        <!-- CURRENT CARD -->
        <section class="card cardLarge viewPanel" data-panel="current">
          <div class="cardHeader">
            <div>
              <div class="titleSm">Current weather</div>
              <div class="place" id="dvCityCountry">â€”</div>
              <div class="date" id="dvCurrDate">â€”</div>
            </div>

            <div class="tempBlock">
              <div class="iconCircle">
                <img id="imgCurrentIcon" alt="" width="64" height="64" />
              </div>
              <div class="temp">
                <span id="dvCurrTemp">--</span><span class="deg">Â°</span>
              </div>
            </div>
          </div>

          <div class="metrics">
            <div class="metric">
              <div class="metricLabel">Feels like</div>
              <div class="metricVal"><span id="pFeelsLike">--</span>Â°</div>
            </div>

            <div class="metric">
              <div class="metricLabel">Humidity</div>
              <div class="metricVal"><span id="pHumidity">--</span>%</div>
            </div>

            <div class="metric">
              <div class="metricLabel">Wind</div>
              <div class="metricVal windLine">
                <span id="pWind">--</span>
                <span id="windArrowCurrent" class="windArrow">â¤</span>
              </div>
            </div>

            <div class="metric highlight">
              <div class="metricLabel">Playability</div>
              <div class="metricVal" id="playScore">--</div>
              <div class="metricSub" id="playText">â€”</div>
            </div>

            <div class="metric">
              <div class="metricLabel">Sunrise</div>
              <div class="metricVal" id="pSunrise">--</div>
              <div class="metricSub" id="pDayLength">Day length: --</div>
            </div>

            <div class="metric">
              <div class="metricLabel">Sunset</div>
              <div class="metricVal" id="pSunset">--</div>
              <div class="metricSub">&nbsp;</div>
            </div>
          </div>
        </section>

        <!-- MAP + RAIN TIMELINE CARD -->
        <section class="card cardSmall viewPanel" data-panel="current">
          <div class="mapHeader">
            <div class="titleSm">Nowcast</div>
            <div class="rainMsg" id="rainMessage">â€”</div>
          </div>

          <div class="mapWrap">
            <div id="map" class="map"></div>
          </div>

          <div class="rainTimeline" id="rainTimeline"></div>
        </section>

        <!-- BEST TEE TIME -->
        <section class="card cardWide viewPanel" data-panel="current">
          <div class="titleSm">Best tee time today</div>
          <div class="teeRow">
            <div class="teeLine">ğŸ•’ <b id="bestTeeTime">--</b></div>
            <div class="teeLine">â­ <b id="bestTeeScore">--</b></div>
          </div>
          <div class="teeReason" id="bestTeeReason">â€”</div>
          <div class="smallNote">Always within daylight.</div>
        </section>

        <!-- DAILY -->
        <section class="card cardWide viewPanel hidden" data-panel="daily">
          <div class="cardTop">
            <div class="titleSm">Daily forecast</div>
            <div class="hint">Click a day to switch the hourly view</div>
          </div>
          <div id="dailyForecast" class="dailyGrid"></div>
        </section>

        <!-- HOURLY -->
        <section class="card cardWide viewPanel hidden" data-panel="hourly">
          <div class="cardTop">
            <div class="titleSm">Hourly forecast (3-hour blocks)</div>
            <select id="ddlDay" class="select"></select>
          </div>
          <div id="hourlyHours" class="hourlyGrid"></div>
        </section>

        <!-- COURSES PANEL -->
        <section class="card cardWide viewPanel hidden" data-panel="courses">
          <div class="titleSm">Courses</div>
          <p class="muted">
            Use the <b>Golf course</b> search box at the top to filter, then select a course to load its forecast.
            Add favourites using the â˜† button.
          </p>
        </section>

      </section>
    </main>
  </div>
</body>
</html>
