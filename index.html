<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fairway Forecast</title>

  <!-- One reliable font family: system-ui stack (fast, no load issues) -->
  <link rel="stylesheet" href="./style.css?v=100" />

  <!-- Leaflet (map) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
    defer
  ></script>

  <!-- config.js must set window.APP_CONFIG -->
  <script src="./config.js?v=100"></script>

  <!-- Supabase UMD -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script src="./script.js?v=100" defer></script>
</head>

<body>
  <a class="sr-only sr-skip" href="#main">Skip to main content</a>

  <div class="app">
    <!-- Sidebar -->
    <aside class="side">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true">‚õ≥</div>
        <div class="brand__text">
          <div class="brand__name">Fairway Forecast</div>
          <div class="brand__tag">Golf-first weather</div>
        </div>
      </div>

      <nav class="nav" aria-label="Sections">
        <button class="nav__btn is-active" data-view="current" type="button">
          <span class="nav__icon" aria-hidden="true">‚òÄÔ∏è</span><span>Current</span>
        </button>
        <button class="nav__btn" data-view="hourly" type="button">
          <span class="nav__icon" aria-hidden="true">üïí</span><span>Hourly</span>
        </button>
        <button class="nav__btn" data-view="daily" type="button">
          <span class="nav__icon" aria-hidden="true">üìÖ</span><span>Daily</span>
        </button>
      </nav>

      <div class="side__controls">
        <label class="label" for="ddlUnits">Units</label>
        <select class="select" id="ddlUnits">
          <option value="C">¬∞C</option>
          <option value="F">¬∞F</option>
        </select>

        <div class="side__meta">
          <div id="coursesStatus" class="meta">Courses: loading‚Ä¶</div>
          <div id="appStatus" class="meta"></div>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main class="main" id="main">
      <!-- Top: quick chips + unified search -->
      <header class="top">
        <div class="chips" id="quickChips" aria-label="Quick locations"></div>

        <section class="searchCard" aria-label="Search">
          <div class="searchCard__row">
            <div class="searchCard__field">
              <label class="label" for="txtSearch">Search location or golf course</label>
              <input
                id="txtSearch"
                class="input"
                type="text"
                placeholder="e.g. Swindon, GB or Royal Troon Golf Club"
                autocomplete="off"
              />
              <div id="searchSuggestions" class="suggestions is-hidden" role="listbox" aria-label="Suggestions"></div>
            </div>

            <div class="searchCard__actions">
              <button id="btnSearch" class="btn" type="button">Search</button>
              <button id="btnGeo" class="btn btn--ghost" type="button" title="Use my location" aria-label="Use my location">‚åñ</button>
              <button
                id="btnFav"
                class="btn btn--star"
                type="button"
                aria-label="Toggle favourite"
                aria-pressed="false"
                title="Favourite"
              >
                ‚òÜ
              </button>
            </div>
          </div>

          <div class="searchCard__row searchCard__row--compact">
            <div class="favRow">
              <label class="label" for="ddlFavs">Favourites</label>
              <select id="ddlFavs" class="select select--compact">
                <option value="">Select a favourite‚Ä¶</option>
              </select>
            </div>
            <div class="hint">
              Tip: favourites work for both places and courses.
            </div>
          </div>
        </section>
      </header>

      <!-- CONTENT -->
      <section class="layout">
        <!-- LEFT: HERO (Playability + H1) -->
        <section class="card card--hero" id="cardHero">
          <div class="heroHead">
            <div>
              <div class="kicker">Selected</div>
              <h1 class="h1" id="h1Title">‚Äî</h1>
              <div class="sub" id="subTitle">‚Äî</div>
            </div>

            <div class="tempBadge" aria-label="Current temperature">
              <img id="imgIcon" class="tempBadge__icon" alt="" />
              <div class="tempBadge__temp">
                <span id="currTemp">--</span><span class="deg">¬∞</span>
              </div>
            </div>
          </div>

          <!-- PLAYABILITY HERO -->
          <div class="playHero" id="playHero" aria-label="Playability score">
            <div class="playHero__top">
              <div class="playHero__title">Playability</div>

              <button id="btnPlayInfo" class="iconBtn" type="button" aria-label="Playability info" aria-expanded="false">i</button>
            </div>

            <div class="playHero__score">
              <span id="playScoreWhole">--</span><span class="playHero__slash">/</span><span class="playHero__ten">10</span>
            </div>

            <div class="playHero__band" id="playBand">‚Äî</div>
            <div class="playHero__meta" id="playMeta">‚Äî</div>

            <!-- SOLID POPOVER -->
            <div id="playPopover" class="popover is-hidden" role="dialog" aria-hidden="true">
              <div class="popover__head">
                <div class="popover__title">What affects Playability?</div>
                <button id="btnPlayClose" class="iconBtn iconBtn--close" type="button" aria-label="Close">√ó</button>
              </div>

              <ul class="popover__list">
                <li><b>Wind</b>: stronger gusts reduce control and comfort.</li>
                <li><b>Rain probability</b>: higher chance = higher disruption.</li>
                <li><b>Temperature comfort</b>: very cold/very hot reduces enjoyment.</li>
                <li><b>Ground conditions</b>: recent rain suggests softer/wetter turf.</li>
              </ul>
              <div class="popover__note">Score is a guide ‚Äî always check the radar and course advice.</div>
            </div>
          </div>

          <!-- CONDITIONS (body) -->
          <div class="grid2" id="conditionsGrid">
            <div class="metric">
              <div class="metric__k">Feels like</div>
              <div class="metric__v"><span id="feelsLike">--</span>¬∞</div>
            </div>
            <div class="metric">
              <div class="metric__k">Humidity</div>
              <div class="metric__v"><span id="humidity">--</span>%</div>
            </div>
            <div class="metric">
              <div class="metric__k">Wind</div>
              <div class="metric__v">
                <span id="wind">--</span>
                <span class="windDir" id="windDir">‚Äî</span>
              </div>
            </div>
            <div class="metric">
              <div class="metric__k">Sunrise / Sunset</div>
              <div class="metric__v">
                <span id="sunrise">--</span>
                <span class="sep">‚Ä¢</span>
                <span id="sunset">--</span>
              </div>
              <div class="metric__s" id="dayLength">Day length: ‚Äî</div>
            </div>
          </div>

          <!-- BEST TEE TIME -->
          <div class="teeCard" id="teeCard">
            <div class="teeCard__top">
              <div class="teeCard__title">Best tee time today</div>
              <div class="teeCard__sun">Sunrise <b id="teeSunrise">--</b> ‚Ä¢ Sunset <b id="teeSunset">--</b></div>
            </div>

            <div class="teeCard__main" id="teeMain">
              <div class="teeTime" id="bestTeeTime">‚Äî</div>
              <div class="teeScore" id="bestTeeScore">‚Äî</div>
            </div>

            <div class="teeCard__msg" id="teeMsg">‚Äî</div>
          </div>
        </section>

        <!-- RIGHT: MAP + RAIN -->
        <section class="card card--map" id="cardMap">
          <div class="cardHead">
            <div class="cardTitle">Nowcast</div>
            <div class="cardRight" id="rainMessage">‚Äî</div>
          </div>

          <div class="mapWrap">
            <div id="map" class="map" aria-label="Map"></div>
          </div>

          <div class="timeline" id="rainTimeline" aria-label="Rain timeline"></div>
        </section>

        <!-- DAILY -->
        <section class="card card--wide is-hidden" data-panel="daily" id="cardDaily">
          <div class="cardHead">
            <div class="cardTitle">Daily forecast</div>
            <div class="cardHint">Tap a day to update the hourly view</div>
          </div>
          <div class="daily" id="dailyForecast"></div>
        </section>

        <!-- HOURLY -->
        <section class="card card--wide is-hidden" data-panel="hourly" id="cardHourly">
          <div class="cardHead">
            <div class="cardTitle">Hourly forecast (3-hour blocks)</div>
            <select id="ddlDay" class="select select--compact"></select>
          </div>
          <div class="hourly" id="hourlyForecast"></div>
        </section>

        <!-- DISCLAIMER -->
        <footer class="disclaimer">
          <p>
            <b>Disclaimer:</b> Fairway Forecast uses third-party weather data (OpenWeather). Forecasts can change rapidly.
            Always check local conditions and course communications before play.
          </p>
        </footer>
      </section>

      <!-- Toast -->
      <div class="toast is-hidden" id="toast" role="status" aria-live="polite"></div>
    </main>
  </div>
</body>
</html>
